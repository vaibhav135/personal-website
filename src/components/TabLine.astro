---
import { navItems } from '../data/nav';

interface Props {
  currentFile: string;
}

const { currentFile } = Astro.props;

const filetypeColor: Record<string, string> = {
  typescript: 'var(--cyan)',
  directory: 'var(--yellow)',
  lua: 'var(--purple)',
  bash: 'var(--green)',
  markdown: 'var(--orange)',
};
---

<nav class="tabline" aria-label="Page navigation">
  <a href="/" class="tabline__home" aria-label="Home">nvim</a>
  {navItems.map((item) => (
    <a
      href={item.href}
      class:list={['tabline__tab', { 'tabline__tab--active': item.filename === currentFile }]}
      aria-current={item.filename === currentFile ? 'page' : undefined}
    >
      <span class="tabline__dot" style={`background: ${filetypeColor[item.filetype] ?? 'var(--fg)'}`} />
      <span class="tabline__label">{item.label}</span>
      <span class="tabline__close" aria-hidden="true">&times;</span>
    </a>
  ))}
  <div class="tabline__fill" />
</nav>

<style>
  .tabline {
    display: flex;
    background: var(--bg-dark);
    border-bottom: 1px solid var(--current-line);
    overflow-x: auto;
    scrollbar-width: none;
  }

  .tabline::-webkit-scrollbar {
    display: none;
  }

  .tabline__tab {
    display: flex;
    align-items: center;
    gap: 0.5rem;
    padding: 0.45rem 1rem;
    color: var(--ui-tab-inactive-fg);
    background: var(--ui-tab-inactive-bg);
    border-right: 1px solid var(--current-line);
    white-space: nowrap;
    text-decoration: none;
    font-size: 0.85rem;
    transition: color 0.15s ease, background 0.15s ease;
    position: relative;
  }

  .tabline__tab::after {
    content: '';
    position: absolute;
    bottom: 0;
    left: 0;
    right: 0;
    height: 2px;
    background: transparent;
    transition: background 0.15s ease;
  }

  .tabline__tab:hover {
    color: var(--fg);
    text-decoration: none;
  }

  .tabline__tab--active {
    color: var(--ui-tab-active-fg);
    background: var(--ui-tab-active-bg);
  }

  .tabline__tab--active::after {
    background: var(--purple);
  }

  .tabline__dot {
    width: 7px;
    height: 7px;
    border-radius: 50%;
    flex-shrink: 0;
  }

  .tabline__close {
    opacity: 0;
    font-size: 0.75rem;
    line-height: 1;
    transition: opacity 0.15s ease;
  }

  .tabline__tab:hover .tabline__close {
    opacity: 0.5;
  }

  .tabline__home {
    display: flex;
    align-items: center;
    padding: 0.45rem 0.75rem;
    color: var(--green);
    font-weight: 700;
    font-size: 0.85rem;
    text-decoration: none;
    border-right: 1px solid var(--current-line);
    background: var(--bg-dark);
    white-space: nowrap;
    transition: color 0.15s ease;
  }

  .tabline__home:hover {
    color: var(--purple);
    text-decoration: none;
  }

  .tabline__fill {
    flex: 1;
    background: var(--bg-dark);
  }

  @media (max-width: 480px) {
    .tabline__tab {
      padding: 0.4rem 0.6rem;
      font-size: 0.75rem;
      gap: 0.3rem;
    }

    .tabline__close {
      display: none;
    }
  }
</style>
